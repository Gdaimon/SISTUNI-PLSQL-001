-- Incrementa el salario
CREATE OR REPLACE PROCEDURE UPDATESALEMP4
(CODIGO EMP.EMPNO%TYPE, INCREMENTO EMP.SAL%TYPE)
IS
    V_Salario EMP.SAL%TYPE := NULL;
	ExcPer Exception;
	Mensaje VARCHAR2(1000);
BEGIN
    UPDATE EMP
        SET SAL = SAL + INCREMENTO
        WHERE EMPNO = CODIGO
		RETURNING SAL INTO V_Salario;
	IF( V_SALARIO IS NULL ) THEN
	   RAISE ExcPer;
	END IF;
    COMMIT;
    DBMS_OUTPUT.PUT_LINE(' PROCESO OK. SALARIO: ' || TO_CHAR(V_SALARIO));
EXCEPTION
	WHEN ExcPer THEN
		Mensaje := 'ERROR, NO EXISTE EL CODIGO.';
		ROLLBACK;
		DBMS_OUTPUT.PUT_LINE(Mensaje);
		RAISE_APPLICATION_ERROR(-20001, Mensaje);
	WHEN OTHERS THEN
		Mensaje := 'ERROR: ' || sqlerrm ;
		ROLLBACK;
		DBMS_OUTPUT.PUT_LINE(Mensaje);
		RAISE_APPLICATION_ERROR(-20002, Mensaje);
END;


EXEC UPDATESALEMP4 (9999,5000);
